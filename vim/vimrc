" Theme
colorscheme onedark

" Always display status line
set laststatus=2

" Window title format: 'vim - file [+-=] (1 of n)'
set title titlestring=vim\ -\ %t%(\ [%M]%)%a

" Show horizontal cursor line
set cursorline

" Show line numbers relative to the current one
set number relativenumber

" Scroll when over number of lines
set scrolloff=2

" Wrap preserving words and indentation
set linebreak breakindent

" Identify wrapped lines with @ and indentation
let &showbreak='@ '

" Indentation
set expandtab tabstop=4 softtabstop=4 shiftwidth=4

" Show whitespaces with ':set list'
set listchars=eol:$,tab:>·,trail:~,extends:>,precedes:<,space:·

" Indent on newlines
set smartindent

" Allow backspace
set backspace=2

" Show pattern match results. Default case-insensitive search on all line occurrences
set incsearch ignorecase smartcase gdefault

" Enable syntax highlighting
syntax on

" No '-- INSERT --' in status line
set noshowmode

" Show partial command while typing it
set showcmd

" No ESC delay
set timeoutlen=1000 ttimeoutlen=0

" Allow buffers to keep unsaved changes
set hidden

" Change cursor shape on different mode
if exists('$ITERM_PROFILE')
    " Vertical bar in insert mode
    let &t_SI = "\<Esc>]50;CursorShape=1\x7"
    " Block in normal mode
    let &t_EI = "\<Esc>]50;CursorShape=0\x7"
    " Underline in replace mode
    let &t_SR = "\<Esc>]50;CursorShape=2\x7"
else
    " Vertical bar in insert mode
    let &t_SI = "\e[5 q"
    " Block in normal mode
    let &t_SR = "\e[4 q"
    " Underline in replace mode
    let &t_EI = "\e[1 q"
endif

" Temp files
set noswapfile nobackup undodir=~/.vim/undodir undofile

" Move .viminfo file
set viminfo=%,<800,'10,/50,:100,h,f0,n~/.vim/cache/.viminfo
"           | |    |   |   |    | |  + viminfo file path
"           | |    |   |   |    | + file marks 0-9,A-Z 0=NOT stored
"           | |    |   |   |    + disable 'hlsearch' loading viminfo
"           | |    |   |   + command-line history saved
"           | |    |   + search history saved
"           | |    + files marks saved
"           | + lines saved each register (old name for <, vi6.2)
"           + save/restore buffer list

" Mouse support
" Drains a crazy amount of battery power if enabled
" set mouse=a


" Custom mappings
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" Move lines with Up/Down
nnoremap <Down> :m .+1<CR>==
nnoremap <Up> :m .-2<CR>==
inoremap <Down> <Esc>:m .+1<CR>==gi
inoremap <Up> <Esc>:m .-2<CR>==gi
vnoremap <Down> :m '>+1<CR>gv=gv
vnoremap <Up> :m '<-2<CR>gv=gv


" Plugins
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
" Load opt plugins
for plugin in readfile(expand('~/.vim/opt-plugins.vim'))
    " Ignore comments
    if plugin =~ '^[^"#]'
        let plugin = substitute(plugin, '.*/', '', '')
        exe 'packadd!' plugin
    endif
endfor

" Enable buffers line
let g:airline#extensions#tabline#enabled = 1
